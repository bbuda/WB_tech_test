У каждого ПВЗ WB есть вывеска над входом (прикрепляю фотки). Эти вывески должны круглосуточно светиться для повышения индекса видимости бренда, 
однако, многие менеджеры против правил намеренно их выключают. Это плохо, нужно ругать таких менеджеров.
Наша задача - определить светимость вывесок.
Исходные данные: фотки входной группы ПВЗ, идеальный YOLO-детектор вывесок mAP=1.
Сложности: солнечная погода, тусклое свечение и др.

Предложи, пожалуйста, подходы к решению задачи определения светимости вывесок с учетом указанных усложнений и, возможно, опираясь на некоторые дополнительные свои выводы и предположения.


----
(Как я понял, разметки нет, неизвестно изначально является ли вывеска тусклой) 
# Решение-безлайн:

Предположение: большинство изображений если не считать время суток и свечение вывески больше ничем особым выделяющимся не отличаются.
Относительно редко льет дождь, что он станет заметным на изображении с вывеской, некачественных фотографий тоже должны быть в сильном меньшинстве.
Вывеску ПВЗ фотографируют обычно с небольшого расстояния, камера на современном телефоне спокойно справится с этой задаче

Вывески обычно чуть ли не всегда одного и того же размера, следовательно как базовую меру светимости можно принять среднее значение пикселя в bounding boxes вывески,
получится вектор с тремя значениями R,G и B соответственно (для большего упрощения в безлайн можно и сам вектор усреднить, чтобы получить одного значение)

Затем, случайно сэмплируюя из датасета я бы просмотрел изображений 100-500. Визуально разделил бы на вывески тусклые и нетусклые, расчитал бы для каждой группы
вектор средних значений в bounding boxes по каждому из каналов для каждого из изображений, полученные вектора в группах усреднить.

Перебирая новые изображения и расситывая вектора средних пикселей вывескок я бы по евклидову расстоянию определял к какой существующей группе новый вектор "ближе".
Евликдово расстояние выбрано, потому что большая разница в одном цветовом канале может сильно повляить на итоговый ответ, расстояние манхэттена сглаживало бы эту разницу

Остается только отобрать ранее не встречающиеся изображения, чтобы на этой выборке замерить accuracy, F1 и прочие метрики

Простота, скорость разработки и высокая скорость в real-time системе -  чуть ли не за O(1), т.к достаточно лишь посчитать расстояние между векторами 
+ на руках появляется значение метрик на отложенной выборке, это открывает возможность совершенствовать решение и замерять дальнейший прирост

# Модификации:
Довольно полезной информацией является время суток, можно попробовать извлечь ее пытаясь отыскать голубые или черные группы пикселей (небо)
или же по всему изображению можно расситывать вектор средних по каждому каналу, вечером/ночью будет преобладать вектора с меньшими значениями, чем в солнечный день.

После извлечения информации об окружающей среде ее можно добавить к вектору средних значней по каждому из цветовых каналов вывески, 
затем поверх этого обучить логистическую регрессию или любой другой алгоритм. Тут уже потребуется разметка не на 100 изображений, гарантированно придеться привлекать других людей

Имея в виду, что у алгоритма детекции вывески mAP=1, можно развернуть тензор как вектор и передать на вход линейной модели или же передать тензор сверточной нейронной сети.
Данных становится много и кроме разметки теперь требуются ресурсы на обучение

Наиболее интересным подходом является сведение задачи определения светимости вывесок из бинарной классификации к мульти-классификации

Алексей Вашкевич, [26.09.2024 3:41]
Изображения с тусклыми изображениями и нетусклыми объединяются в один фрейм (только если дисбаланс классов не ярко выраженный) 
затем расситываются процентили по каждому из каналов векторов средних значений вывесок. Итого получается 10 процентилей,
если есть дисбаланс сильный тогда изображения не будут объединяться в один фрейм и процентили рассчитаются только по нетусклой выборке. 
Дальше точно также как я описывал выше, новое изображение приходит на вход, bounding boxes вывески трансформируется в вектор, 
затем по евклидовому расстонию подбирается "ближайший" вектор процентилей, тот который подошел, например процентиль 0.8 и будет ялвяться оценкой светимости.
Такая более подробная информация может быть полезна, т.к вывески рано или поздно горят менее ярко и благодаря такому подхожду получится
